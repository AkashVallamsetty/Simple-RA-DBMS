LOAD EMPLOYEE
TEMP <- PROJECT Ssn,Salary FROM EMPLOYEE
Q1 <- SELECT Salary >= 30000 FROM TEMP
T1 <- PROJECT Ssn,Super_ssn,Bdate FROM EMPLOYEE
T2 <- CROSS T1 T1
T3 <- SELECT T11_Super_ssn == T12_Ssn FROM T2
T4 <- SELECT T11_Bdate == T12_Bdate FROM T3
Q2 <- PROJECT T11_Ssn,T11_Super_ssn,T11_Bdate FROM T4
RENAME T11_Ssn TO Ssn FROM Q2
RENAME T11_Super_ssn TO Super_ssn FROM Q2
RENAME T11_Bdate TO Bdate FROM Q2
X1 <- PROJECT Ssn,Sex FROM EMPLOYEE
LOAD WORKS_ON
X2 <- CROSS X1 WORKS_ON
X3 <- SELECT Ssn == Essn FROM X2
X4 <- PROJECT Ssn,Sex,Pno FROM X3
MALE <- SELECT Sex == 1 FROM X4
FEMALE <- SELECT Sex == 0 FROM X4
X5 <- CROSS MALE FEMALE
X6 <- SELECT MALE_Pno == FEMALE_Pno FROM X5
Q3 <- PROJECT FEMALE_Pno FROM X6
RENAME FEMALE_Pno TO Pno FROM Q3
LOAD DEPARTMENT
Y1 <- PROJECT Mgr_ssn FROM DEPARTMENT
Y2 <- PROJECT Essn,Pno FROM WORKS_ON
Y3 <- CROSS Y1 Y2
Y4 <- PROJECT Ssn,Super_ssn FROM EMPLOYEE
Y5 <- SELECT Mgr_ssn == Essn FROM Y3
Y6 <- CROSS Y4 Y2
Y7 <- SELECT Ssn == Essn FROM Y6
Y9 <- CROSS Y7 Y5
Y10 <- SELECT Super_ssn == Mgr_ssn FROM Y9
Y11 <- SELECT Y7_Pno == Y5_Pno FROM Y10
Q4 <- PROJECT Ssn,Super_ssn,Y7_Pno FROM Y11
RENAME Y7_Pno TO Pno FROM Q4
EXPORT Q1
EXPORT Q2
EXPORT Q3
EXPORT Q4
QUIT


